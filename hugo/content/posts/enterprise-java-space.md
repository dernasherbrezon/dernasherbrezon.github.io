---
title: "Enterprise Java на страже космоса"
date: 2017-04-08T12:48:18+01:00
draft: false
cover: /img/enterprise-java-space/24dbbef6d38b4de59fef6b67a0308e40.jpg
tags:
  - космонавтика
  - разработка
  - open source
  - java
  - satnogs
---
> Научно-технический прогресс постепенный по своей природе. Никто не берет горсть песка с пляжа и делает из нее компьютер. Мы берем грубые инструменты и создаем с помощью них более качественные. Затем с помощью последних еще более точные и так далее. Каждое малое усовершенствование - это ступенька прогресса и все они должны быть пройдены. 
>
> Председатель Шенчжи Ян.

![](/img/enterprise-java-space/24dbbef6d38b4de59fef6b67a0308e40.jpg)

В сознании каждого человека есть одна простая мысль: космические технологии - это сложно. На самом деле это не так. Не все технологии, применимые в космической отрасли - это Rocket science. И последние успехи в космонавтике, ренессанс космической тематики подвигли меня на поиск проблемных областей, которые простой Enterprise Java разработчик может улучшить.
<cut />
<h2>Предисловие</h2>
Самый простой способ - это пойти на сайт любой компании, работающей в космической отрасли, и поискать вакансии. Несмотря на то, что <a href="http://www.spacex.com/careers">SpaceX</a> ищет программистов, мне было отказано на этапе резюме. Видимо, государственные контракты от NASA не позволяют им нанимать людей из других стран. Видимо, по этой же причине <a href="https://www.linkedin.com/jobs/search/?keywords=nasa&f_C=2003">NASA</a> даже не ответили на моё резюме. <a href="http://global.jaxa.jp/about/employ/index.html">JAXA</a> набирает не-программистов и тех, у кого японский не ниже уровня jlpt2.

С небольшими частными компаниями должно было бы быть значительно лучше. Но <a href="http://www.planetaryresources.com/careers/#pri-workplace">Planetary Resources</a> отказали на этапе резюме. Видимо, слишком маленькие, чтобы держать под рукой Enterprise Java разработчика. <a href="https://www.planet.com/company/careers/?office=View%20All&department=Software%20Engineering">Planet</a> попросили написать программу на Си. Я конечно вспомнил синтаксис и смог, но после пары интервью они отказали. Видимо, слишком маленькая компания, у которой нет офиса в России, и переезд в другую страну они не потянут.

Ну и, наконец, дефолт сити. <a href="https://www.roscosmos.ru/23310/">Роскосмос</a> - ни списка вакансий, ни требований.

<h2>Станции наблюдения за спутниками</h2>
Но мне повезло, и я случайно обнаружил проект <a href="https://geektimes.ru/post/241834/">Satnogs</a>. Это проект по созданию любительских станций наблюдения за спутниками по всему миру. Можно самому распечатать на 3д принтере части станции и по инструкции собрать. Также у них есть центральный сервер, который рассылает на станции запросы для наблюдения за пролетающими спутниками и собирает данные со всего мира: <a href="https://network.satnogs.org">https://network.satnogs.org</a>. 

Для меня, как новичка в этой области, было не совсем понятно кому и зачем это нужно. Однако, повертевшись на <a href="https://community.satnogs.org">форумах</a> и в mailing листах <a href="http://www.cubesat.org/mailinglist">cubesat</a>, я стал немного представлять проблематику.

Обычно маленькие спутники и кубсаты запускают университеты для отработки той или иной <a href="http://sail.planetary.org">технологии</a>. Иногда их запускают даже солидные коммерческие компании для финальных тестов своих <a href="https://www.nasa.gov/centers/ames/engineering/projects/nodes">наработок</a>. Обычно эти компании и университеты достаточно небольшие и не могут себе позволить <a href="https://geektimes.ru/company/mailru/blog/280132/">флот</a> для наблюдения за спутниками. Однако, понимание того, как ведет себя технология, важно в <a href="https://geektimes.ru/post/251506/">течении всего времени</a> полета, а не только во время пятиминутного интервала связи. Именно поэтому университеты и компании <a href="http://www.space.aau.dk/aausat4/index.php?n=Main.ReportBeaconsAndPassInfo">заинтересованы</a> в постоянном слежении за своими спутниками.

И тут на помощь должны прийти интернет и <a href="https://en.wikipedia.org/wiki/Space_Communications_and_Navigation_Program">глобальная сеть наблюдения</a>.

<h2>Телеметрия</h2>
По мере того, как спутник вращается на орбите, он периодически посылает телеметрию. <a href="https://ru.wikipedia.org/wiki/Телеметрия">Телеметрия</a> - это текущее состояние системы: напряжение батарей, момент вращения, температура и пр. Если постоянно получать эту информацию, то можно построить график изменения данных во времени и провести анализ.

Поскольку я прежде всего программист, меня заинтересовала именно программная часть, а в особенности digital signal processing. Как из .wav файла можно получить данные. Но прежде чем расчехлять прибор и начать кодить необходимо проанализировать существующие решения. Если вкратце, то эта область застряла где-то в 60х. Энтузиасты пересылают данные в виде <a href="http://www.dk3wn.info/p/?cat=8">скриншотов</a> к windows программам. 

![](/img/enterprise-java-space/192591f0007246fc8cc434b47e76ef4f.jpg)

Хотелось бы что-то более современное. Например, облачный сервис, который на вход получает .wav файл, а на выходе возвращает json. Почему именно такая архитектура?

<ol>
<li>для того, чтобы отправить данные и получить результат не нужно специального ПО. Достаточно лишь curl, который есть во всех linux дистрибутивах;</li>
<li>результат в текстовом формате упрощает разработку и интеграцию;</li>
<li>микросервисная архитектура. Такой сервис будет отлично встраивается в другие более сложные системы.</li>
</ol>
Следующим этапом был выбор технологий. Поскольку специализированные железки для декодирования радио сигналов ну совсем никак не поставить в обычные датацентры, то необходимо программное декодирование. Тут все просто: <a href="http://gnuradio.org">gnuradio</a>. Это стандарт де-факто для программного декодирования - достаточно мощный и бесплатный инструмент, который поддерживает множество режимов и способов работы. Как раз то, что нужно для того, чтобы работать с зоопарком различных способов кодирования сигнала. Daniel Estévez <a href="https://github.com/daniestevez/gr-satellites">написал</a> замечательные скрипты по декодированию сигналов различных спутников и приложил рабочие примеры.

![](/img/enterprise-java-space/e9ddc3c4bc8e448f8ca1d6f7e0b99e79.png)

Казалось бы вот оно, счастье. Однако, и тут есть несколько ложек дегтя:

<ol>
<li><a href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.ru.html">GPLv2</a>. Это не позволит вам писать коммерческий софт по декодированию сигналов. И уж точно не подходит для облачного сервиса - кто-то должен платить за хостинг.</li>
<li>Безумная связка C/C++/Python/Swig. Если вкратце, то в gnuradio есть понятие блока. Это такой атомарный преобразователь сигнала. Когда сигнал декодируется данные проходят через множества, связанных между собой, блоков, и на выходе из последнего блока получается результат. Так вот, блоки можно писать на С++ и python. А раз можно писать, значит кто-то обязательно напишет. В итоге часть блоков написана на Python 2, часть на <a href="https://github.com/gnuradio/gnuradio/issues/1153">Python 3</a>, часть на C++, который иногда <a href="http://stackoverflow.com/questions/24898791/gnu-radio-build-error-no-rule-to-make-target-filter-generated-includes-neede">не компилируется</a> и <a href="https://wiki.gnuradio.org/index.php/MacInstall">не всегда устанавливается</a>, и все это связано через <a href="http://www.swig.org">SWIG</a>.</li>
</ol>
Переписывать уже рабочий код, который используется уже много лет и знаком многим энтузиастам, задача неблагодарная. Но помучившись с виртуальными машинами и продравшись сквозь десяток ошибок компиляции, я решил пойти на невозможное: переписать ключевые блоки на <a href="https://github.com/dernasherbrezon/jradio">Java</a>. Разумеется бездумно переписывать все подряд блоки не имеет смысла, поэтому я решил проверить концепцию, переписав только блоки, нужные для декодирования <a href="https://github.com/daniestevez/gr-aausat">aausat-4</a>. В итоге у меня получилось сделать бинарно совместимые с gnuradio блоки и декодировать сигнал.

Поскольку концепция оказалась успешной, я решил запустить <a href="https://leosatdata.com">облачный сервис</a>, который по сути предоставляет REST интерфейс к библиотеке <a href="https://github.com/dernasherbrezon/jradio">jradio</a>. Следующим этапом я планирую подключить его к <a href="https://network.satnogs.org">satnogs</a> для декодирования данных. 

<h2>Выводы</h2>
Даже если вы Enterprise Java разработчик, вы можете помочь Элону. Возможно, по прошествии времени Вы сможете говорить внукам, что шаттл, который летает между Марсом и Землей, каждую секунду выполняет Ваш код. Дерзайте!